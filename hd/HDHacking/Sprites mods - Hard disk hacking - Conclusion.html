<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"><head>
<title>Sprites mods - Hard disk hacking - Conclusion</title>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
<link rel="stylesheet" type="text/css" href="Sprites%20mods%20-%20Hard%20disk%20hacking%20-%20Conclusion_files/style-new.css">
<link rel="stylesheet" type="text/css" href="Sprites%20mods%20-%20Hard%20disk%20hacking%20-%20Conclusion_files/print.css" media="print">
<link type="application/rss+xml" rel="alternate" title="Sprites Mods" href="http://spritesmods.com/rss.php">
<script src="Sprites%20mods%20-%20Hard%20disk%20hacking%20-%20Conclusion_files/ca-pub-6055011648930388.js" type="text/javascript" async=""></script><script id="COINWIDGETCOM_JQUERY" src="Sprites%20mods%20-%20Hard%20disk%20hacking%20-%20Conclusion_files/jquery.js"></script><link href="Sprites%20mods%20-%20Hard%20disk%20hacking%20-%20Conclusion_files/coin.css" type="text/css" rel="stylesheet" id="COINWIDGETCOM_STYLESHEET"><script id="COINWIDGETCOM_INFO0.22189429616349543" src="Sprites%20mods%20-%20Hard%20disk%20hacking%20-%20Conclusion_files/lookup.php"></script></head>
<body>

<div id="header"><span id="sitename"><span id="sitenamebig">SpritesMods</span>.com</span><h1>Hard disk hacking - Conclusion</h1></div>


<div id="left">
<p>
<a href="http://spritesmods.com/?art=main">Welcome</a><br></p><ul id="mainmenu"><li><a href="http://spritesmods.com/?art=hardware">Hardware stuff</a></li><li><a href="http://spritesmods.com/?art=hacks">Hacks</a><ul id="submenu"><li><a href="http://spritesmods.com/?art=vpx500">Hacking the VPx500</a></li><li><a href="http://spritesmods.com/?art=hddhack">Hard disk hacking</a></li><li><a href="http://spritesmods.com/?art=zx3hack">Hacking the Kodak Zx3</a></li><li><a href="http://spritesmods.com/?art=rtl8366sb">Dumb to managed switch conversion</a></li><li><a href="http://spritesmods.com/?art=rapidisnake">Snake on a Keyboard</a></li><li><a href="http://spritesmods.com/?art=twitter1943">Twittering vintage arcade game</a></li><li><a href="http://spritesmods.com/?art=ledbl">LEDs replacing CCFL backlight</a></li><li><a href="http://spritesmods.com/?art=keybled">Laptop keyboard LED</a></li><li><a href="http://spritesmods.com/?art=wskpsip">Convert a SMC WSKP100 to use SIP</a></li><li><a href="http://spritesmods.com/?art=mouseeye">Optical mouse-cam</a></li><li><a href="http://spritesmods.com/?art=picframe">Use a cheap digital photoframe as a second display for your PC</a></li><li><a href="http://spritesmods.com/?art=sweexusb">Add USB to a Sweex LB000021 router</a></li><li><a href="http://spritesmods.com/?art=ljdisplay">Standalone HPLJ display hack</a></li><li><a href="http://spritesmods.com/?art=swordfish">Damocles' Swordfish</a></li><li><a href="http://spritesmods.com/?art=wtcluster">Cluster using WT-300s</a></li></ul></li><li><a href="http://spritesmods.com/?art=consoles">Console hacking</a></li><li><a href="http://spritesmods.com/?art=security">Security</a></li><li><a href="http://spritesmods.com/?art=software">Software</a></li><li><a href="http://spritesmods.com/?art=nabaztag">Nabaztag</a></li><li><a href="http://spritesmods.com/?art=about">About Spritesmods</a></li></ul></div>

<div id="right">
<div id="righttop">
<p><a href="http://spritesmods.com/?art=hddhack&amp;page=1"><strong>Page 1</strong><br></a>Intro</p><p><a href="http://spritesmods.com/?art=hddhack&amp;page=2"><strong>Page 2</strong><br></a>Parts on the PCB</p><p><a href="http://spritesmods.com/?art=hddhack&amp;page=3"><strong>Page 3</strong><br></a>Hooking up JTAG</p><p><a href="http://spritesmods.com/?art=hddhack&amp;page=4"><strong>Page 4</strong><br></a>Injecting code</p><p><a href="http://spritesmods.com/?art=hddhack&amp;page=5"><strong>Page 5</strong><br></a>Persistence</p><p><a href="http://spritesmods.com/?art=hddhack&amp;page=6"><strong>Page 6</strong><br></a>Software flashing</p><p><a href="http://spritesmods.com/?art=hddhack&amp;page=7"><strong>Page 7</strong><br></a>Other uses</p><p><strong>Page 8</strong><br>Conclusion (+ discussion / remarks)</p><p>
</p>
</div>
<div id="rightbottom">
<p>
Do you like my hacking? If so, please consider leaving something in the<br>
</p>
<form action="https://www.paypal.com/cgi-bin/webscr" method="post">
<input name="cmd" value="_donations" type="hidden">
<input name="business" value="AWHK8LYRDDS3C" type="hidden">
<input name="lc" value="GB" type="hidden">
<input name="item_name" value="Spritesmods.com" type="hidden">
<input name="no_note" value="0" type="hidden">
<input name="cn" value="Remarks" type="hidden">
<input name="no_shipping" value="1" type="hidden">
<input name="rm" value="1" type="hidden">
<input name="return" value="http://spritesmods.com/?art=main&amp;thanks=1" type="hidden">
<input name="currency_code" value="EUR" type="hidden">
<input name="bn" value="PP-DonationsBF:donate.png:NonHosted" type="hidden">
<input src="Sprites%20mods%20-%20Hard%20disk%20hacking%20-%20Conclusion_files/donate.png" name="submit" alt="PayPal, de veilige en complete manier van online betalen." border="0" type="image">
<!--
<img alt="" border="0" src="https://www.paypalobjects.com/nl_NL/i/scr/pixel.gif" width="1" height="1">
-->
</form>

<p>
Or use Bitcoins:<br>
<script src="Sprites%20mods%20-%20Hard%20disk%20hacking%20-%20Conclusion_files/coin.js"></script>
<script>
CoinWidgetCom.go({
	wallet_address: "16wKm29FmTLmYSrDtBXB4zLYGsqfrTwcEC"
	, currency: "bitcoin"
	, counter: "count"
	, alignment: "bl"
	, qrcode: true
	, auto_show: false
	, lbl_button: "Donate"
	, lbl_address: "My Bitcoin Address:"
	, lbl_count: "donations"
	, lbl_amount: "BTC"
});
</script><span data-coinwidget-instance="0" class="COINWIDGETCOM_CONTAINER"><a class="COINWIDGETCOM_BUTTON_BITCOIN" href="#"><img src="Sprites%20mods%20-%20Hard%20disk%20hacking%20-%20Conclusion_files/icon_bitcoin.png"><span>Donate</span></a><span>0</span></span>
</p>


<p>
<br>Current contents:
<br>EUR282 (about $375.06) and a bunch of cool hardware.
</p>


<p>
Follow Spritesmods on <a href="http://twitter.com/SpritesMods">Twitter</a>!
</p>
</div>
</div>
<div id="center">
<p></p><h1>Conclusion
</h1>
<p></p>
<!-- google_ad_section_start -->
<p>
So, there you have it. While the hard disk controller is a beast without much data 
known about it, it's still perfectly well possible to reverse engineer it and to
write custom code for it. The unknown-ness of the controller does make it harder
to write generic hacks, which makes me doubtfull that a thing like the evil 
firmware patch will ever be seen in the wild: it's much easier to just get another
zero-day software exploit than reverse engineer the firmware of every single hard
disk every server you stumble upon has.
</p>
<p>
I also hope to have proven that a broken hard disk is something you can still use. 
While the mechanics of a broken HD probably are shot, the PCB still contains an 
usable embedded system, which actually is pretty powerful considering you can usually
get broken hard disks for free.
</p>
<p>
Releasing the source-code for a security project always is a nasty subject. I want to
release code, but I do not want to be responsible for a lot of permanently hacked
servers... I decided to compromise: you can download the code I used 
<a href="http://spritesmods.com/hddhack/hddhack.tgz">here</a>, but I removed the shadow-replacement code.
Make note: I'm not going to support the process to get all this running in any way;
it's a hack, you figure it out.
</p>
<!-- google_ad_section_end -->
<p>	<script async="" src="Sprites%20mods%20-%20Hard%20disk%20hacking%20-%20Conclusion_files/adsbygoogle.js"></script>
	<!-- singlebigad -->
	<ins data-adsbygoogle-status="done" class="adsbygoogle" style="display:inline-block;width:728px;height:90px" data-ad-client="ca-pub-6055011648930388" data-ad-slot="3668631373"><ins id="aswift_0_expand" style="display:inline-table;border:none;height:90px;margin:0;padding:0;position:relative;visibility:visible;width:728px;background-color:transparent"><ins id="aswift_0_anchor" style="display:block;border:none;height:90px;margin:0;padding:0;position:relative;visibility:visible;width:728px;background-color:transparent"><iframe marginwidth="0" marginheight="0" vspace="0" hspace="0" allowtransparency="true" scrolling="no" allowfullscreen="true" onload="var i=this.id,s=window.google_iframe_oncopy,H=s&amp;&amp;s.handlers,h=H&amp;&amp;H[i],w=this.contentWindow,d;try{d=w.document}catch(e){}if(h&amp;&amp;d&amp;&amp;(!d.body||!d.body.firstChild)){if(h.call){setTimeout(h,0)}else if(h.match){try{h=s.upd(h,i)}catch(e){}w.location.replace(h)}}" id="aswift_0" name="aswift_0" style="left:0;position:absolute;top:0;" frameborder="0" height="90" width="728"></iframe></ins></ins></ins>
	<script>
	(adsbygoogle = window.adsbygoogle || []).push({});
	</script>
	</p><p id="prevnext"><a href="http://spritesmods.com/?art=hddhack&amp;page=7">« Prev</a>&nbsp;8&nbsp;</p><p><strong>Last 10 comments</strong> <a href="http://spritesmods.com/?art=hddhack&amp;page=8&amp;showall=true">Show all</a><a id="cmtid2577"></a></p><div class="comment"><strong>Kevin Matthews wrote at 13 Jun 2015, 15.53:</strong><p>Could
 you hide a bit of the hard drive from the OS for your own use?  That 
would really increase what you can do with the drive. No this drive is 
not this 100 GB it's 90 GB now ignore what I am doing...</p></div><a id="cmtid2570"></a><div class="comment"><strong>Wout wrote at 25 May 2015, 12.04:</strong><p>Now,
 a filesystem like btrfs or zfs that has a tree of block checksums going
 all the way up to the root of the tree is protected against this, 
right? The disk can only return the data that was written to it, or it 
would trigger a checksum failure.</p></div><a id="cmtid2566"></a><div class="comment"><strong>mike wrote at 30 Apr 2015, 3.56:</strong><p>This
 is the exact method used to build some data recovery tools. ACE labs 
(from Russia) sells a setup that can flash their recovery firmware to 
all sorts of drives, including many much much newer ones. They intend it
 for data recovery, but of course this technique has been used for a lot
 of other purposes. Being in the forensics side of things, I can tell 
you that you won't find an open JTAG port on many newer drives. Some 
controller manufacturers (SandForce) have gone as far as to encrypt 
their firmware (as well as the data). Not sure anyone has figured out 
how to do this on their drives yet (I know ACE hasn't). Also with SSDs 
taking up the market, the controllers are much much more powerful. 
Modern SSD controllers can be quad-or-hex-core ARM 9+ jobs running at 
800MHz+. An exploit could hide anywhere in one of those.</p></div><a id="cmtid2562"></a><div class="comment"><strong>Aivan wrote at 25 Apr 2015, 22.58:</strong><p>Well,
 nice job. But there is some fw you can extract I guess. WD make HDD for
 Xbox and those one use a different FW u can get on Internet. Also there
 is a DOS aplication that Flash and back up a WD to be complatible for 
the Xbox 360. FW of WD are not so far. I'm not on the pc with that FW 
links, but you can extend this hack. Even the embedded system is an 
interesting thing lol!
Regards - Sorry for Engrish ;P</p></div><a id="cmtid2554"></a><div class="comment"><strong>Krtek wrote at 16 Apr 2015, 19.14:</strong><p>NSA is one step further... :-)
http://www.wired.com/2015/02/nsa-firmware-hacking/</p></div><a id="cmtid2552"></a><div class="comment"><strong>Hitechcomputergeek wrote at 11 Apr 2015, 8.03:</strong><p>What about using the third core, the Cortex-M3, to run stuff (like Linux)?</p></div><a id="cmtid2549"></a><div class="comment"><strong>Sanford Expo wrote at 4 Apr 2015, 21.09:</strong><p>Common
 sense would dictate that any and all reprogrammable firmware should 
have a switch or jumper for manually disabling the reprogramming 
operations(s). Not just on hard drives, but on all hardware. So why is 
common sense not being followed? Hmmm... and convenience and dumb users 
are not valid excuses.</p></div><a id="cmtid2538"></a><div class="comment"><strong>pctek9 wrote at 21 Mar 2015, 18.14:</strong><p>The
 United States is the only superpower supporting freedom and democracy. 
 Now that we know nsa uses this through equation group, just imagine 
what those brilliant little chinese electronic designers have at their 
disposal?  or even the russians?  I bet MSS and FSB have firmware 
rewriters that have not been discovered yet.  Isn't it really time for 
antivirus that scans firmware, and firmware signing, or even a physical 
r/w switch to update firmware?</p></div><a id="cmtid2523"></a><div class="comment"><strong>E:V:A wrote at 3 Mar 2015, 12.27:</strong><p>BTW.
 I assume you've probed for additional serial interfaces? Because all 
M3's are specified to use both JTAG and SW (serial) interfaces for debug
 purposes, which probably mean you should see some dmesg-like output 
during bootup, somwhere... </p></div><a id="cmtid2522"></a><div class="comment"><strong>Casey wrote at 1 Mar 2015, 20.33:</strong><p>Interesting
 article. Sounds like you had some fun working all this out. My laptop 
has killed two HD's so far in less than a year. The errors reported by 
the drive is confusing if not crashing the USB modules in Linux making 
standard recovery rather difficult. I'm thinking that your code might 
help in recovering some of the data off the drives.</p></div><a id="leavecmt"></a>
<div class="comment">
Leave a comment:<form method="post" action="?#leavecmt">
<p>
<input name="page" value="8" type="hidden">
<input name="art" value="hddhack" type="hidden">
<input name="capval" value="1596438833" type="hidden">
Your name:<br>
<input name="name" type="text"><br>
What does this picture say?<br>
<img src="Sprites%20mods%20-%20Hard%20disk%20hacking%20-%20Conclusion_files/captcha.png" alt="Sorry, this is a captcha"><br>
<input name="capfld" value="dkadja" type="hidden">
<input name="dkadja" type="text"><br>
Your comment:<br>
<textarea name="comment" rows="5" cols="60"></textarea><br>
<input name="postcomment" value="Comment" type="submit">
</p>
</form>
</div>
<br><div class="copy">© 2006-2014 Sprite_tm - <a href="http://spritesmods.com/?art=contact&amp;af=Hard%20disk%20hacking">Contact</a></div></div>


</body></html>